# Implementation Plan: User Dashboard for Wallet Management

**Branch**: `004-dashboard` | **Date**: 2025-10-17 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/004-dashboard/spec.md`

**Note**: This plan is generated by the `/speckit.plan` command following the execution workflow in `.specify/templates/commands/plan.md`.

## Summary

Create a cross-platform desktop dashboard application using Tauri framework that provides a GUI wrapper around the existing ArcSign CLI wallet service. The dashboard enables users to create new wallets, import existing wallets from mnemonic phrases, view addresses for all 54 supported blockchains, manage multiple wallets, and export address lists. All wallet data is encrypted and stored exclusively on USB drives for security, with support for Windows, macOS, and Linux platforms.

## Technical Context

**Language/Version**: Rust 1.75+ (Tauri backend), TypeScript 5.0+ (frontend), Go 1.21+ (existing CLI service)
**Primary Dependencies**:
- Tauri 1.5+ (desktop framework)
- React 18+ with TypeScript (frontend UI - decided after Phase 0 research)
- React Hook Form + Zod (form validation)
- Zustand (state management)
- Existing Go CLI: tyler-smith/go-bip39, btcsuite/btcd/btcutil/hdkeychain
**Storage**: USB-only storage (no hard drive), AES-256-GCM + Argon2id encryption
**Testing**: cargo test (Rust), vitest/jest (frontend), go test (CLI integration)
**Target Platform**: Desktop application for Windows 10+, macOS 12+, Linux (Ubuntu 20.04+)
**Project Type**: Desktop GUI application (Tauri = web frontend + Rust backend wrapper)
**Performance Goals**:
- Wallet creation: <3 minutes end-to-end
- Address display: 54 addresses in <15 seconds
- UI responsiveness: <200ms for all interactions
- Export generation: <5 seconds
**Constraints**:
- Offline-capable (no internet required)
- USB-only storage (security requirement)
- Subprocess communication with existing Go CLI
- Cross-platform clipboard/file APIs
- Memory clearing for sensitive data (mnemonics, passwords)
**Scale/Scope**:
- Support up to 10 wallets per user without pagination
- 54 blockchain addresses per wallet
- Single-user desktop application (no multi-user/server component)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### I. Security-First Development ✅

- [x] Private keys/mnemonics stay in USB secure zone → CLI handles encryption, dashboard never persists plaintext
- [x] Argon2id + AES-256-GCM encryption → Existing CLI implementation used via subprocess
- [x] Multi-factor authentication → Application password + Wallet password enforced by CLI
- [x] API credentials isolation → Not applicable (no external API calls in dashboard)
- [x] Logs MUST NOT contain sensitive info → Dashboard will use audit logging through CLI
- [x] Secrets use environment variables → Existing CLI handles secret management

**Status**: ✅ PASS - Dashboard wraps existing secure CLI, no new security vulnerabilities introduced

### II. Test-Driven Development ✅

- [x] Red-Green-Refactor cycle → Will follow TDD for all dashboard components
- [x] Unit + integration + contract tests → Frontend component tests + Rust backend tests + CLI integration tests
- [x] Security tests for sensitive features → Mnemonic display, password input, memory clearing
- [x] Tests pass before commit → CI/CD gates enforced

**Status**: ✅ PASS - TDD approach planned for all three layers (Rust, frontend, CLI integration)

### III. Incremental Progress Over Big Bangs ✅

- [x] 3-5 phases breakdown → Phase breakdown defined below:
  - Phase 1: Tauri shell + USB detection wrapper
  - Phase 2: Wallet creation UI + CLI integration
  - Phase 3: Wallet import UI + mnemonic validation
  - Phase 4: Address display + search/filter
  - Phase 5: Multi-wallet management + export
- [x] Each phase compilable/testable → Each phase delivers working feature subset
- [x] Maximum 3 attempts per approach → Documented in research.md

**Status**: ✅ PASS - Incremental phases defined with clear deliverables

### IV. Composition Over Inheritance ✅

- [x] Prefer interfaces and DI → Tauri commands use Rust traits, React components use composition
- [x] Single responsibility per module → UI components, Tauri backend commands, CLI service wrappers
- [x] Avoid over-abstraction → Direct subprocess calls to CLI, minimal abstraction layers

**Status**: ✅ PASS - Architecture uses composition (React components, Rust command modules)

### V. Documentation-Driven Development ✅

- [x] Update SYSTEM_SPECIFICATION.md post-deployment → Will update after Phase 5 complete
- [x] Architectural decisions documented → research.md documents all decisions
- [x] API contracts documented → Tauri command contracts + CLI command contracts

**Status**: ✅ PASS - API contracts will be generated in Phase 1

### Architecture: MVC Layered ✅

- [x] Model-View-Controller separation:
  - **Model**: Wallet/Address entities (managed by Go CLI service)
  - **View**: React/Svelte frontend UI components
  - **Controller**: Tauri Rust backend commands (orchestration layer)
- [x] Backend-First with Go → Existing Go CLI is backend, Tauri is thin orchestration wrapper
- [x] API Service Isolation → Not applicable (no external APIs)

**Status**: ✅ PASS - Clear MVC separation with Tauri as orchestration layer

**GATE RESULT**: ✅ ALL CHECKS PASSED - Proceed to Phase 0 Research

## Project Structure

### Documentation (this feature)

```
specs/004-dashboard/
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output (technology decisions)
├── data-model.md        # Phase 1 output (entities and state)
├── quickstart.md        # Phase 1 output (developer setup guide)
├── contracts/           # Phase 1 output (API contracts)
│   ├── tauri-commands.yaml     # Tauri backend command definitions
│   └── cli-integration.yaml    # Go CLI subprocess interface
└── tasks.md             # Phase 2 output (/speckit.tasks command - NOT created yet)
```

### Source Code (repository root)

```
# Desktop application structure (Tauri)
dashboard/
├── src-tauri/              # Rust backend
│   ├── src/
│   │   ├── main.rs         # Tauri app entry point
│   │   ├── commands/       # Tauri command handlers
│   │   │   ├── wallet.rs   # Wallet creation/import commands
│   │   │   ├── usb.rs      # USB detection wrapper
│   │   │   └── export.rs   # Address export commands
│   │   ├── cli/            # Go CLI subprocess integration
│   │   │   └── wrapper.rs  # CLI command executor
│   │   └── models/         # Rust data models
│   │       ├── wallet.rs
│   │       └── address.rs
│   ├── tauri.conf.json     # Tauri configuration
│   └── Cargo.toml          # Rust dependencies
│
├── src/                    # Frontend (React/Svelte)
│   ├── components/         # UI components
│   │   ├── WalletCreate.tsx      # Wallet creation flow
│   │   ├── WalletImport.tsx      # Mnemonic import flow
│   │   ├── AddressList.tsx       # Address display with filter/search
│   │   ├── WalletSelector.tsx    # Multi-wallet switcher
│   │   └── MnemonicDisplay.tsx   # Secure mnemonic display
│   ├── pages/              # Main views
│   │   ├── Dashboard.tsx         # Home dashboard
│   │   └── Settings.tsx          # Settings page
│   ├── services/           # Frontend services
│   │   ├── tauri-api.ts          # Tauri command invocations
│   │   └── clipboard.ts          # Clipboard management
│   ├── types/              # TypeScript types
│   │   ├── wallet.ts
│   │   └── address.ts
│   └── App.tsx             # Root component
│
└── tests/
    ├── rust/               # Rust backend tests
    │   ├── commands_test.rs
    │   └── cli_wrapper_test.rs
    ├── frontend/           # Frontend component tests
    │   ├── WalletCreate.test.tsx
    │   └── AddressList.test.tsx
    └── integration/        # End-to-end tests
        └── wallet_lifecycle_test.rs

# Existing Go CLI (unchanged, used via subprocess)
cmd/arcsign/
└── main.go                 # CLI commands: create, restore, generate-all

internal/
├── services/
│   ├── wallet/
│   ├── address/
│   ├── storage/            # USB management
│   └── encryption/
└── models/
```

**Structure Decision**: Tauri application structure with Rust backend (subprocess wrapper for Go CLI) + web frontend (React or Svelte). The dashboard lives in a new `dashboard/` directory at repo root, separate from the existing Go CLI in `cmd/` and `internal/`. This separation allows independent deployment of CLI and GUI while sharing the CLI as a subprocess.

## Complexity Tracking

*No constitutional violations - this section is empty.*
